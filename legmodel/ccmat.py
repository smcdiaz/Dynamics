# -*- co0.5*(a111+a111-a111)ng: utf-8 -*-
"""
Created on Thu Sep 26 21:20:19 2013

@author: Santiago
"""

from plant import *
from cristof import *
from sympy import Matrix

#Simbolos de Cristofel
b111=0.5*(a111+a111-a111)
b112=0.5*(a112+a121-a121)
b113=0.5*(a113+a131-a131)
b114=0.5*(a114+a141-a141)
b115=0.5*(a115+a151-a151)

b121=0.5*(a121+a112-a211)
b122=0.5*(a122+a122-a221)
b123=0.5*(a123+a132-a231)
b124=0.5*(a124+a142-a241)
b125=0.5*(a125+a152-a251)

b131=0.5*(a131+a113-a311)
b132=0.5*(a132+a123-a321)
b133=0.5*(a133+a133-a331)
b134=0.5*(a134+a143-a341)
b135=0.5*(a135+a153-a351)

b141=0.5*(a141+a114-a411)
b142=0.5*(a142+a124-a421)
b143=0.5*(a143+a134-a431)
b144=0.5*(a144+a144-a441)
b145=0.5*(a145+a154-a451)

b151=0.5*(a151+a115-a512)
b152=0.5*(a152+a125-a522)
b153=0.5*(a153+a135-a532)
b154=0.5*(a154+a145-a542)
b155=0.5*(a155+a155-a552)

b211=0.5*(a211+a211-a112)
b212=0.5*(a212+a221-a122)
b213=0.5*(a213+a231-a132)
b214=0.5*(a214+a241-a142)
b215=0.5*(a215+a251-a152)

b221=0.5*(a221+a212-a212)
b222=0.5*(a222+a222-a222)
b223=0.5*(a223+a232-a232)
b224=0.5*(a224+a242-a242)
b225=0.5*(a225+a252-a252)

b231=0.5*(a231+a213-a312)
b232=0.5*(a232+a223-a322)
b233=0.5*(a233+a233-a332)
b234=0.5*(a234+a243-a342)
b235=0.5*(a235+a253-a352)

b241=0.5*(a241+a214-a412)
b242=0.5*(a242+a224-a422)
b243=0.5*(a243+a234-a432)
b244=0.5*(a244+a244-a442)
b245=0.5*(a245+a254-a452)

b251=0.5*(a251+a215-a512)
b252=0.5*(a252+a225-a522)
b253=0.5*(a253+a235-a532)
b254=0.5*(a254+a245-a542)
b255=0.5*(a255+a255-a552)

b311=0.5*(a311+a311-a113)
b312=0.5*(a312+a321-a123)
b313=0.5*(a313+a331-a133)
b314=0.5*(a314+a341-a143)
b315=0.5*(a315+a351-a153)

b321=0.5*(a321+a312-a213)
b322=0.5*(a322+a322-a223)
b323=0.5*(a323+a332-a233)
b324=0.5*(a324+a342-a243)
b325=0.5*(a325+a352-a253)

b331=0.5*(a331+a313-a313)
b332=0.5*(a332+a323-a323)
b333=0.5*(a333+a333-a333)
b334=0.5*(a334+a343-a343)
b335=0.5*(a335+a353-a353)

b341=0.5*(a341+a314-a413)
b342=0.5*(a342+a324-a423)
b343=0.5*(a343+a334-a433)
b344=0.5*(a344+a344-a443)
b345=0.5*(a345+a354-a453)

b351=0.5*(a351+a315-a513)
b352=0.5*(a352+a325-a523)
b353=0.5*(a353+a335-a533)
b354=0.5*(a354+a345-a543)
b355=0.5*(a355+a355-a553)

b411=0.5*(a411+a411-a114)
b412=0.5*(a412+a421-a124)
b413=0.5*(a413+a431-a134)
b414=0.5*(a414+a441-a144)
b415=0.5*(a415+a451-a154)

b421=0.5*(a421+a412-a214)
b422=0.5*(a422+a422-a224)
b423=0.5*(a423+a432-a234)
b424=0.5*(a424+a442-a244)
b425=0.5*(a425+a452-a254)

b431=0.5*(a431+a413-a314)
b432=0.5*(a432+a423-a324)
b433=0.5*(a433+a433-a334)
b434=0.5*(a434+a443-a344)
b435=0.5*(a435+a453-a354)

b441=0.5*(a441+a414-a414)
b442=0.5*(a442+a424-a424)
b443=0.5*(a443+a434-a434)
b444=0.5*(a444+a444-a444)
b445=0.5*(a445+a454-a454)

b451=0.5*(a451+a415-a514)
b452=0.5*(a452+a425-a524)
b453=0.5*(a453+a435-a534)
b454=0.5*(a454+a445-a544)
b455=0.5*(a455+a455-a554)

b511=0.5*(a511+a511-a115)
b512=0.5*(a512+a521-a125)
b513=0.5*(a513+a531-a135)
b514=0.5*(a514+a541-a145)
b515=0.5*(a515+a551-a155)

b521=0.5*(a521+a512-a215)
b522=0.5*(a522+a522-a225)
b523=0.5*(a523+a532-a235)
b524=0.5*(a524+a542-a245)
b525=0.5*(a525+a552-a255)

b531=0.5*(a531+a513-a315)
b532=0.5*(a532+a523-a325)
b533=0.5*(a533+a533-a335)
b534=0.5*(a534+a543-a345)
b535=0.5*(a535+a553-a355)

b541=0.5*(a541+a514-a415)
b542=0.5*(a542+a524-a425)
b543=0.5*(a543+a534-a435)
b544=0.5*(a544+a544-a445)
b545=0.5*(a545+a554-a455)

b551=0.5*(a551+a515-a515)
b552=0.5*(a552+a525-a525)
b553=0.5*(a553+a535-a535)
b554=0.5*(a554+a545-a545)
b555=0.5*(a555+a555-a555)

#Centrifugal and Coriolis matrix
Bq=Matrix([[2*b112,2*b113,2*b114,2*b115,2*b123,2*b124,2*b125,2*b134,2*b135,2*b145],
           [2*b212,2*b213,2*b214,2*b215,2*b223,2*b224,2*b225,2*b234,2*b235,2*b245],
           [2*b312,2*b313,2*b314,2*b315,2*b323,2*b324,2*b325,2*b334,2*b335,2*b345],
           [2*b412,2*b413,2*b414,2*b415,2*b423,2*b424,2*b425,2*b434,2*b435,2*b445], 
           [2*b512,2*b513,2*b514,2*b515,2*b523,2*b524,2*b525,2*b534,2*b535,2*b545]])
        
Cq=Matrix([[b111,b122,b133,b144,b155],
           [b211,b222,b233,b244,b255],
           [b311,b322,b333,b344,b355],
           [b411,b422,b433,b444,b455],
           [b511,b522,b533,b544,b555]])
 
qdot2=Matrix([qd1*qd1,qd2*qd2,qd3*qd3,qd4*qd4,qd5*qd5])

qdqd=Matrix([qd1*qd2,qd1*qd3,qd1*qd4,qd1*qd5,qd2*qd3,qd2*qd4,qd2*qd5,qd3*qd4,qd3*qd5,qd4*qd5])

b=Bq*qdqd+Cq*qdot2
